diff -urNp linux-7120/fs/dcache.c linux-7130/fs/dcache.c
--- linux-7120/fs/dcache.c
+++ linux-7130/fs/dcache.c
@@ -224,7 +224,7 @@ int d_invalidate(struct dentry * dentry)
 static inline struct dentry * __dget_locked(struct dentry *dentry)
 {
 	atomic_inc(&dentry->d_count);
-	if (atomic_read(&dentry->d_count) == 1) {
+	if (!list_empty(&dentry->d_lru)) {
 		dentry_stat.nr_unused--;
 		list_del_init(&dentry->d_lru);
 	}
@@ -591,6 +591,14 @@ void shrink_dcache_parent(struct dentry 
 }
 
 /*
+ * Additional priority levels for dcache zapping.
+ * Value of 0 means no change to priority, higher values mean
+ * less number of dentries zapped from the dentry cache,
+ * per VM pressure event.
+ */
+int dcache_priority = 0;
+
+/*
  * This is called from kswapd when we think we need some
  * more memory, but aren't really sure how much. So we
  * carefully try to free a _bit_ of our dcache, but not
@@ -619,9 +627,9 @@ int shrink_dcache_memory(int priority, u
 	if (!(gfp_mask & __GFP_FS))
 		return 0;
 
-	count = dentry_stat.nr_unused / priority;
-
-	prune_dcache(count);
+	count = dentry_stat.nr_unused / (priority + dcache_priority);
+	if (count > 0)
+		prune_dcache(count);
 	if (RATE_LIMIT(HZ))
 		return kmem_cache_shrink(dentry_cache);
 	return 0;
diff -urNp linux-7120/include/linux/sysctl.h linux-7130/include/linux/sysctl.h
--- linux-7120/include/linux/sysctl.h
+++ linux-7130/include/linux/sysctl.h
@@ -154,6 +154,7 @@ enum
 	VM_OVERCOMMIT_RATIO=16,	/* percent of RAM to allow overcommit in */
 	VM_PAGEBUF=22,		/* struct: Control pagebuf parameters */
 	VM_HUGETLB_POOL=23,	/* int: size of the hugetlb pool, in MB */
+	VM_DCACHE_PRIORITY=24,	/* int: priority of the dcache pool */
 	VM_INACTIVE_CLEAN_PERCENT=25, /* int: percent of inactive thats clean */
 	VM_SKIP_MAPPED_PAGES=27,/* int: don't reclaim pages w/active mappings */
 	VM_OOM_KILL=28,		/* int: limit on concurrent OOM kills */
diff -urNp linux-7120/kernel/sysctl.c linux-7130/kernel/sysctl.c
--- linux-7120/kernel/sysctl.c
+++ linux-7130/kernel/sysctl.c
@@ -45,6 +45,7 @@ int sercons_escape_char = -1;
 
 /* External variables not in a header file. */
 extern int panic_timeout;
+extern int dcache_priority;
 extern int C_A_D;
 extern int bdf_prm[], bdflush_min[], bdflush_max[];
 extern int sysctl_overcommit_memory;
@@ -381,6 +382,8 @@ static ctl_table vm_table[] = {
 	{VM_HUGETLB_POOL, "hugetlb_pool", &htlbpool_max, sizeof(int), 0644,
 			NULL, &hugetlb_sysctl_handler},
 #endif
+	{VM_DCACHE_PRIORITY, "dcache_priority", &dcache_priority,
+	 sizeof(dcache_priority), 0644, NULL, &proc_dointvec},
 	{VM_INACTIVE_CLEAN_PERCENT, "inactive_clean_percent",
 		&inactive_clean_percent, sizeof(inactive_clean_percent),
 		0644, NULL, &proc_dointvec},
