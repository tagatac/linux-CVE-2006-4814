diff -urN -X dontdiff linux-2.4.20-1.1931.2.90.ent/arch/s390x/kernel/binfmt_elf32.c linux-2.4.20-2.1.27.z2/arch/s390x/kernel/binfmt_elf32.c
--- linux-2.4.20-1.1931.2.90.ent/arch/s390x/kernel/binfmt_elf32.c	2003-04-09 16:12:07.000000000 -0400
+++ linux-2.4.20-2.1.27.z2/arch/s390x/kernel/binfmt_elf32.c	2003-04-03 12:10:24.000000000 -0500
@@ -38,7 +38,6 @@
 #define ELF_PLAT_INIT(_r, load_addr) \
 	do { \
 	_r->gprs[14] = 0; \
-	current->thread.flags |= S390_FLAG_31BIT; \
 	} while(0)
 
 #define USE_ELF_CORE_DUMP
@@ -89,6 +88,7 @@
 #ifdef __KERNEL__
 #define SET_PERSONALITY(ex, ibcs2)			\
 do {							\
+	current->thread.flags |= S390_FLAG_31BIT;	\
 	if (ibcs2)                                      \
 		set_personality(PER_SVR4);              \
 	else if (current->personality != PER_LINUX32)   \
diff -urN -X dontdiff linux-2.4.20-1.1931.2.90.ent/include/asm-s390x/elf.h linux-2.4.20-2.1.27.z2/include/asm-s390x/elf.h
--- linux-2.4.20-1.1931.2.90.ent/include/asm-s390x/elf.h	2003-04-09 16:12:07.000000000 -0400
+++ linux-2.4.20-2.1.27.z2/include/asm-s390x/elf.h	2003-04-03 12:28:44.000000000 -0500
@@ -39,7 +39,6 @@
 #define ELF_PLAT_INIT(_r, load_addr) \
 	do { \
 	_r->gprs[14] = 0; \
-	current->thread.flags = 0; \
 	} while(0)
 
 #define USE_ELF_CORE_DUMP
@@ -79,6 +78,7 @@
 #ifdef __KERNEL__
 #define SET_PERSONALITY(ex, ibcs2)			\
 do {							\
+	current->thread.flags = 0;			\
 	if (ibcs2)					\
 		set_personality(PER_SVR4);		\
 	else if (current->personality != PER_LINUX32)	\
