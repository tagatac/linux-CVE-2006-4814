--- linux-2.4.20/arch/ppc64/kernel/ptrace.c.ptrace	2003-04-21 18:57:07.000000000 -0400
+++ linux-2.4.20/arch/ppc64/kernel/ptrace.c	2003-04-21 21:25:15.000000000 -0400
@@ -322,7 +322,7 @@
 		break;
 	}
 out_tsk:
-	free_task_struct(child);
+	put_task_struct(child);
 out:
 	unlock_kernel();
 	return ret;
@@ -346,4 +346,5 @@
 		send_sig(current->exit_code, current, 1);
 		current->exit_code = 0;
 	}
+	recalc_sigpending();
 }
--- linux-2.4.20/arch/ppc64/kernel/ptrace32.c.ptrace	2003-04-21 18:57:13.000000000 -0400
+++ linux-2.4.20/arch/ppc64/kernel/ptrace32.c	2003-04-21 21:25:36.000000000 -0400
@@ -468,7 +468,7 @@
 		break;
 	}
 out_tsk:
-	free_task_struct(child);
+	put_task_struct(child);
 out:
 	unlock_kernel();
 	return ret;
