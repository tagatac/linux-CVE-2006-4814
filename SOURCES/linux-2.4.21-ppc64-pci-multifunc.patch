diff -urNp linux-360/drivers/pci/pci.c linux-361/drivers/pci/pci.c
--- linux-360/drivers/pci/pci.c
+++ linux-361/drivers/pci/pci.c
@@ -1528,17 +1528,22 @@ struct pci_dev * __devinit pci_scan_slot
 	u8 hdr_type;
 
 	for (func = 0; func < 8; func++, temp->devfn++) {
-		if (func && !is_multi)		/* not a multi-function device */
-			continue;
 		if (pci_read_config_byte(temp, PCI_HEADER_TYPE, &hdr_type))
 			continue;
 		temp->hdr_type = hdr_type & 0x7f;
 
 		dev = pci_scan_device(temp);
-		if (!dev)
-			continue;
+		if (!pcibios_scan_all_fns() && func == 0) {
+			if (!dev)
+				break;
+		} else {
+			if (!dev)
+				continue;
+			is_multi = 1;
+		}
+		
 		pci_name_device(dev);
-		if (!func) {
+		if (!first_dev) {
 			is_multi = hdr_type & 0x80;
 			first_dev = dev;
 		}
@@ -1552,6 +1557,14 @@ struct pci_dev * __devinit pci_scan_slot
 
 		/* Fix up broken headers */
 		pci_fixup_device(PCI_FIXUP_HEADER, dev);
+
+		/*
+		 * If this is a single function device
+		 * don't scan past the first function.
+		 */
+		if (!is_multi)
+			break;
+
 	}
 	return first_dev;
 }
diff -urNp linux-360/include/asm-alpha/pci.h linux-361/include/asm-alpha/pci.h
--- linux-360/include/asm-alpha/pci.h
+++ linux-361/include/asm-alpha/pci.h
@@ -50,6 +50,7 @@ struct pci_controller {
    bus numbers.  */
 
 #define pcibios_assign_all_busses()	1
+#define pcibios_scan_all_fns()		0
 
 #define PCIBIOS_MIN_IO		alpha_mv.min_io_address
 #define PCIBIOS_MIN_MEM		alpha_mv.min_mem_address
diff -urNp linux-360/include/asm-arm/pci.h linux-361/include/asm-arm/pci.h
--- linux-360/include/asm-arm/pci.h
+++ linux-361/include/asm-arm/pci.h
@@ -18,6 +18,8 @@ static inline void pcibios_penalize_isa_
 #include <asm/scatterlist.h>
 #include <asm/io.h>
 
+#define pcibios_scan_all_fns()		0
+
 struct pci_dev;
 
 /* Allocate and map kernel buffer using consistent mode DMA for a device.
diff -urNp linux-360/include/asm-i386/pci.h linux-361/include/asm-i386/pci.h
--- linux-360/include/asm-i386/pci.h
+++ linux-361/include/asm-i386/pci.h
@@ -14,6 +14,7 @@ extern unsigned int pcibios_assign_all_b
 #else
 #define pcibios_assign_all_busses()	0
 #endif
+#define pcibios_scan_all_fns()		0
 
 extern unsigned long pci_mem_start;
 #define PCIBIOS_MIN_IO		0x1000
diff -urNp linux-360/include/asm-ia64/pci.h linux-361/include/asm-ia64/pci.h
--- linux-360/include/asm-ia64/pci.h
+++ linux-361/include/asm-ia64/pci.h
@@ -15,6 +15,7 @@
  * loader.
  */
 #define pcibios_assign_all_busses()     0
+#define pcibios_scan_all_fns()		0
 
 #define PCIBIOS_MIN_IO		0x1000
 #define PCIBIOS_MIN_MEM		0x10000000
diff -urNp linux-360/include/asm-m68k/pci.h linux-361/include/asm-m68k/pci.h
--- linux-360/include/asm-m68k/pci.h
+++ linux-361/include/asm-m68k/pci.h
@@ -34,6 +34,7 @@ struct pci_bus_info
 };
 
 #define pcibios_assign_all_busses()	0
+#define pcibios_scan_all_fns()		0
 
 extern inline void pcibios_set_master(struct pci_dev *dev)
 {
diff -urNp linux-360/include/asm-mips/pci.h linux-361/include/asm-mips/pci.h
--- linux-360/include/asm-mips/pci.h
+++ linux-361/include/asm-mips/pci.h
@@ -19,6 +19,7 @@ extern unsigned int pcibios_assign_all_b
 #else
 #define pcibios_assign_all_busses()	0
 #endif
+#define pcibios_scan_all_fns()		0
 
 #define PCIBIOS_MIN_IO		0x1000
 #define PCIBIOS_MIN_MEM		0x10000000
diff -urNp linux-360/include/asm-mips64/pci.h linux-361/include/asm-mips64/pci.h
--- linux-360/include/asm-mips64/pci.h
+++ linux-361/include/asm-mips64/pci.h
@@ -19,6 +19,7 @@ extern unsigned int pcibios_assign_all_b
 #else
 #define pcibios_assign_all_busses()	0
 #endif
+#define pcibios_scan_all_fns()		0
 
 #define PCIBIOS_MIN_IO		0x1000
 #define PCIBIOS_MIN_MEM		0x10000000
diff -urNp linux-360/include/asm-parisc/pci.h linux-361/include/asm-parisc/pci.h
--- linux-360/include/asm-parisc/pci.h
+++ linux-361/include/asm-parisc/pci.h
@@ -259,6 +259,7 @@ extern inline void pcibios_register_hba(
 **   to zero for legacy platforms and one for PAT platforms.
 */
 #define pcibios_assign_all_busses()     (pdc_type == PDC_TYPE_PAT)
+#define pcibios_scan_all_fns()		0
 
 #define PCIBIOS_MIN_IO          0x10
 #define PCIBIOS_MIN_MEM         0x1000 /* NBPG - but pci/setup-res.c dies */
diff -urNp linux-360/include/asm-ppc/pci.h linux-361/include/asm-ppc/pci.h
--- linux-360/include/asm-ppc/pci.h
+++ linux-361/include/asm-ppc/pci.h
@@ -16,6 +16,7 @@
 extern int pci_assign_all_busses;
 
 #define pcibios_assign_all_busses()	(pci_assign_all_busses)
+#define pcibios_scan_all_fns()		0
 
 #define PCIBIOS_MIN_IO		0x1000
 #define PCIBIOS_MIN_MEM		0x10000000
diff -urNp linux-360/include/asm-ppc64/pci.h linux-361/include/asm-ppc64/pci.h
--- linux-360/include/asm-ppc64/pci.h
+++ linux-361/include/asm-ppc64/pci.h
@@ -25,6 +25,12 @@ extern int pcibios_assign_all_busses(voi
 #define PCIBIOS_MIN_IO		0x1000
 #define PCIBIOS_MIN_MEM		0x10000000
 
+/*
+ * ppc64 can have multifunction devices that do not respond to function 0. 
+ * In this case we must scan all functions.
+ */
+#define pcibios_scan_all_fns()     1
+
 static inline void pcibios_set_master(struct pci_dev *dev)
 {
 	/* No special bus mastering setup handling */
diff -urNp linux-360/include/asm-sh/pci.h linux-361/include/asm-sh/pci.h
--- linux-360/include/asm-sh/pci.h
+++ linux-361/include/asm-sh/pci.h
@@ -10,6 +10,7 @@
    or architectures with incomplete PCI setup by the loader */
 
 #define pcibios_assign_all_busses()	1
+#define pcibios_scan_all_fns()		0
 
 #if defined(CONFIG_CPU_SUBTYPE_ST40STB1)
 /* These are currently the correct values for the STM overdrive board. 
diff -urNp linux-360/include/asm-sparc/pci.h linux-361/include/asm-sparc/pci.h
--- linux-360/include/asm-sparc/pci.h
+++ linux-361/include/asm-sparc/pci.h
@@ -8,6 +8,7 @@
  * or architectures with incomplete PCI setup by the loader.
  */
 #define pcibios_assign_all_busses()	0
+#define pcibios_scan_all_fns()		0
 
 #define PCIBIOS_MIN_IO		0UL
 #define PCIBIOS_MIN_MEM		0UL
diff -urNp linux-360/include/asm-sparc64/pci.h linux-361/include/asm-sparc64/pci.h
--- linux-360/include/asm-sparc64/pci.h
+++ linux-361/include/asm-sparc64/pci.h
@@ -11,6 +11,7 @@
  * or architectures with incomplete PCI setup by the loader.
  */
 #define pcibios_assign_all_busses()	0
+#define pcibios_scan_all_fns()		0
 
 #define PCIBIOS_MIN_IO		0UL
 #define PCIBIOS_MIN_MEM		0UL
diff -urNp linux-360/include/asm-x86_64/pci.h linux-361/include/asm-x86_64/pci.h
--- linux-360/include/asm-x86_64/pci.h
+++ linux-361/include/asm-x86_64/pci.h
@@ -20,6 +20,7 @@ extern unsigned int pcibios_assign_all_b
 #else
 #define pcibios_assign_all_busses()	0
 #endif
+#define pcibios_scan_all_fns()		0
 
 extern unsigned long pci_mem_start;
 #define PCIBIOS_MIN_IO		0x1000
